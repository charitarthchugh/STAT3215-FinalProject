```{r setup}
library(tidyverse)
library(plyr)
```

Getting the compressed data, reading it, and filtering for missing values.

```{r}
data.dir <- "./Chugh-Charitarth-Data"
df_list <- list()
for (i in list.files(data.dir)) {
  if (i != "readme.html") {
    d <- read_csv(file.path(data.dir, i))
    d <- d %>% filter(DepDelay > 15 & !is.na(NASDelay))
    df_list[[i]] <- d
  }
}
df <- ldply(df_list, rbind) # merge all the data frames into one.
df <- df %>% select(DepDelay, CarrierDelay, TaxiIn, TaxiOut, Distance, WeatherDelay, NASDelay, SecurityDelay, LateAircraftDelay)
```
```{r}
df <- df %>% select(DepDelay, CarrierDelay, TaxiIn, TaxiOut, Distance, WeatherDelay, NASDelay, SecurityDelay, LateAircraftDelay)
```
```{r}
write.csv(df[c("DepDelay", "CarrierDelay", "TaxiIn", "TaxiOut", "Distance", "WeatherDelay", "NASDelay", "SecurityDelay", "LateAircraftDelay")], "filtered2.csv")
```

